import pandas as pd
import pandas as pd

DQC_TEMPLATE = pd.DataFrame([
    {"Field": "Customer ID", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Customer ID cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Customer ID", "Check Type": "Uniqueness", "SQL Template": "SELECT '{runId}' AS run_id, 'Uniqueness' as check_type, 'Duplicate Customer IDs found' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IN (SELECT {dq_field_to_check} FROM {table} GROUP BY {dq_field_to_check} HAVING COUNT(*) > 1);"},
    {"Field": "Email Address", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Email Address cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Email Address", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Email Address must contain @ symbol' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT LIKE '%@%';"},
    {"Field": "Phone Number", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Phone Number cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Phone Number", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Phone Number must be at least 10 digits' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE LENGTH({dq_field_to_check}) < 10;"},
    {"Field": "Date of Birth", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Date of Birth cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Date of Birth", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Date of Birth cannot be in the future' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} > CURRENT_DATE();"},
    {"Field": "Postal Code", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Postal Code cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Postal Code", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Postal Code must be a valid code' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT IN (SELECT postcode FROM valid_postcodes);"},
    {"Field": "Transaction Date", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Transaction Date cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Transaction Date", "Check Type": "Timeliness", "SQL Template": "SELECT '{runId}' AS run_id, 'Timeliness' as check_type, 'Transaction Date should be within 1 year' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} < DATEADD(year, -1, CURRENT_DATE());"},
    {"Field": "Order Amount", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Order Amount cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Order Amount", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Order Amount must be positive' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} <= 0;"},
    {"Field": "Product Code", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Product Code cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Product Code", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Product Code must exist in valid product list' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT IN (SELECT code FROM valid_products);"},
    {"Field": "Account Number", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Account Number cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Account Number", "Check Type": "Uniqueness", "SQL Template": "SELECT '{runId}' AS run_id, 'Uniqueness' as check_type, 'Duplicate Account Numbers found' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IN (SELECT {dq_field_to_check} FROM {table} GROUP BY {dq_field_to_check} HAVING COUNT(*) > 1);"},
    {"Field": "Account Number", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Account Number must be 10 digits' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE LENGTH({dq_field_to_check}) != 10;"},
    {"Field": "Customer Name", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Customer Name cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Customer Name", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Customer Name must contain only letters' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} RLIKE '^[A-Za-z ]+$' = FALSE;"},
    {"Field": "SSN", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'SSN cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "SSN", "Check Type": "Uniqueness", "SQL Template": "SELECT '{runId}' AS run_id, 'Uniqueness' as check_type, 'Duplicate SSNs found' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IN (SELECT {dq_field_to_check} FROM {table} GROUP BY {dq_field_to_check} HAVING COUNT(*) > 1);"},
    {"Field": "SSN", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'SSN must be in XXX-XX-XXXX format' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} RLIKE '^[0-9]{3}-[0-9]{2}-[0-9]{4}$' = FALSE;"},
    {"Field": "Salary", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Salary cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Salary", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Salary must be non-negative' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} < 0;"},
    {"Field": "Hire Date", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Hire Date cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Hire Date", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Hire Date cannot be in the future' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} > CURRENT_DATE();"},
    {"Field": "Country Code", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Country Code cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Country Code", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Country Code must be valid' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT IN (SELECT code FROM valid_countries);"},
    {"Field": "Product Price", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Product Price cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Product Price", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Product Price must be positive' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} < 0;"},
    {"Field": "Quantity", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Quantity cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Quantity", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Quantity must be at least 1' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} < 1;"},
    {"Field": "Website URL", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Website URL cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Website URL", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Website URL must be a valid URL format' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} RLIKE '^(https?|ftp)://[^\s/$.?#].[^\s]*$' = FALSE;"},
    {"Field": "Age", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Age cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Age", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Age must be between 0 and 120' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT BETWEEN 0 AND 120;"},
    {"Field": "ZIP Code", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'ZIP Code cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "ZIP Code", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'ZIP Code must be 5 digits' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} RLIKE '^[0-9]{5}$' = FALSE;"},
    {"Field": "Employee ID", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Employee ID cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Employee ID", "Check Type": "Uniqueness", "SQL Template": "SELECT '{runId}' AS run_id, 'Uniqueness' as check_type, 'Duplicate Employee IDs found' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IN (SELECT {dq_field_to_check} FROM {table} GROUP BY {dq_field_to_check} HAVING COUNT(*) > 1);"},
    {"Field": "Invoice Number", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Invoice Number cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Invoice Number", "Check Type": "Uniqueness", "SQL Template": "SELECT '{runId}' AS run_id, 'Uniqueness' as check_type, 'Duplicate Invoice Numbers found' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IN (SELECT {dq_field_to_check} FROM {table} GROUP BY {dq_field_to_check} HAVING COUNT(*) > 1);"},
    {"Field": "Currency Code", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Currency Code cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Currency Code", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Currency Code must be valid' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} NOT IN (SELECT code FROM valid_currencies);"},
    {"Field": "Tax Rate", "Check Type": "Completeness", "SQL Template": "SELECT '{runId}' AS run_id, 'Completeness' as check_type, 'Tax Rate cannot be NULL' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} IS NULL;"},
    {"Field": "Tax Rate", "Check Type": "Validity", "SQL Template": "SELECT '{runId}' AS run_id, 'Validity' as check_type, 'Tax Rate must be between 0 and 100' as details, \"{table}\" as table_name, \"{dq_field_to_check}\" as field_name, {dq_field_to_check} as field_value, '{record_id_field}' as record_identifier_name, {record_id_field} as record_identifier_value, current_timestamp() as run_time FROM {table} WHERE {dq_field_to_check} < 0 OR {dq_field_to_check} > 100;"}
])

